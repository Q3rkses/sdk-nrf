<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta charset="utf-8" />
<meta name="generator" content="Docutils 0.21.2: https://docutils.sourceforge.io/" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Bluetooth: Channel Map Updates</title>
<style type="text/css">

/* Minimal style sheet for the HTML output of Docutils.                    */
/*                                                                         */
/* :Author: Günter Milde, based on html4css1.css by David Goodger          */
/* :Id: $Id: minimal.css 9545 2024-02-17 10:37:56Z milde $                                                               */
/* :Copyright: © 2015, 2021 Günter Milde.                                  */
/* :License: Released under the terms of the `2-Clause BSD license`_,      */
/*    in short:                                                            */
/*                                                                         */
/*    Copying and distribution of this file, with or without modification, */
/*    are permitted in any medium without royalty provided the copyright   */
/*    notice and this notice are preserved.                                */
/*                                                                         */
/*    This file is offered as-is, without any warranty.                    */
/*                                                                         */
/* .. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause     */

/* This CSS3 stylesheet defines rules for Docutils elements without        */
/* HTML equivalent. It is required to make the document semantics visible. */
/*                                                                         */
/* .. _validates: http://jigsaw.w3.org/css-validator/validator$link        */

/* titles */
p.topic-title,
p.admonition-title,
p.system-message-title {
  font-weight: bold;
}
p.sidebar-title,
p.rubric {
  font-weight: bold;
  font-size: larger;
}
p.rubric {
  color: maroon;
}
p.subtitle,
p.section-subtitle,
p.sidebar-subtitle {
  font-weight: bold;
  margin-top: -0.5em;
}
h1 + p.subtitle {
  font-size: 1.6em;
}
a.toc-backref {
  color: inherit;
  text-decoration: none;
}

/* Warnings, Errors */
.system-messages h2,
.system-message-title,
pre.problematic,
span.problematic {
  color: red;
}

/* Inline Literals */
.docutils.literal {
  font-family: monospace;
  white-space: pre-wrap;
}
/* do not wrap at hyphens and similar: */
.literal > span.pre { white-space: nowrap; }

/* keep line-breaks (\n) visible */
.pre-wrap { white-space: pre-wrap; }

/* Lists */

/* compact and simple lists: no margin between items */
.simple  li, .simple  ul, .simple  ol,
.compact li, .compact ul, .compact ol,
.simple  > li p, dl.simple  > dd,
.compact > li p, dl.compact > dd {
  margin-top: 0;
  margin-bottom: 0;
}
/* Nested Paragraphs */
p:first-child { margin-top: 0; }
p:last-child { margin-bottom: 0; }
details > p:last-child { margin-bottom: 1em; }

/* Table of Contents */
.contents ul.auto-toc { /* section numbers present */
  list-style-type: none;
}

/* Enumerated Lists */
ol.arabic     { list-style: decimal }
ol.loweralpha { list-style: lower-alpha }
ol.upperalpha { list-style: upper-alpha }
ol.lowerroman { list-style: lower-roman }
ol.upperroman { list-style: upper-roman }

/* Definition Lists and Derivatives */
dt .classifier { font-style: italic }
dt .classifier:before {
  font-style: normal;
  margin: 0.5em;
  content: ":";
}
/* Field Lists and similar */
/* bold field name, content starts on the same line */
dl.field-list,
dl.option-list,
dl.docinfo {
  display: flow-root;
}
dl.field-list > dt,
dl.option-list > dt,
dl.docinfo > dt {
  font-weight: bold;
  clear: left;
  float: left;
  margin: 0;
  padding: 0;
  padding-right: 0.25em;
}
/* Offset for field content (corresponds to the --field-name-limit option) */
dl.field-list > dd,
dl.option-list > dd,
dl.docinfo > dd {
  margin-left:  9em; /* ca. 14 chars in the test examples, fit all Docinfo fields */
}
/* start nested lists on new line */
dd > dl:first-child,
dd > ul:first-child,
dd > ol:first-child {
  clear: left;
}
/* start field-body on a new line after long field names */
dl.field-list > dd > *:first-child,
dl.option-list > dd > *:first-child
{
  display: inline-block;
  width: 100%;
  margin: 0;
}

/* Bibliographic Fields (docinfo) */
dl.docinfo pre.address {
  font: inherit;
  margin: 0.5em 0;
}
dl.docinfo > dd.authors > p { margin: 0; }

/* Option Lists */
dl.option-list > dt { font-weight: normal; }
span.option { white-space: nowrap; }

/* Footnotes and Citations  */

.footnote, .citation { margin: 1em 0; } /* default paragraph skip (Firefox) */
/* hanging indent */
.citation { padding-left: 2em; }
.footnote { padding-left: 1.7em; }
.footnote.superscript { padding-left: 1.0em; }
.citation > .label { margin-left: -2em; }
.footnote > .label { margin-left: -1.7em; }
.footnote.superscript > .label { margin-left: -1.0em; }

.footnote > .label + *,
.citation > .label + * {
  display: inline-block;
  margin-top: 0;
  vertical-align: top;
}
.footnote > .backrefs + *,
.citation > .backrefs + * {
  margin-top: 0;
}
.footnote > .label + p, .footnote > .backrefs + p,
.citation > .label + p, .citation > .backrefs + p {
  display: inline;
  vertical-align: inherit;
}

.backrefs { user-select: none; }
.backrefs > a { font-style: italic; }

/* superscript footnotes */
a[role="doc-noteref"].superscript,
.footnote.superscript > .label,
.footnote.superscript > .backrefs {
  vertical-align: super;
  font-size: smaller;
  line-height: 1;
}
a[role="doc-noteref"].superscript > .fn-bracket,
.footnote.superscript > .label > .fn-bracket {
  /* hide brackets in display but leave for copy/paste */
  display: inline-block;
  width: 0;
  overflow: hidden;
}
[role="doc-noteref"].superscript + [role="doc-noteref"].superscript {
  padding-left: 0.15em; /* separate consecutive footnote references */
  /* TODO: unfortunately, "+" also selects with text between the references. */
}

/* Alignment */
.align-left   {
  text-align: left;
  margin-right: auto;
}
.align-center {
  text-align: center;
  margin-left: auto;
  margin-right: auto;
}
.align-right  {
  text-align: right;
  margin-left: auto;
}
.align-top    { vertical-align: top; }
.align-middle { vertical-align: middle; }
.align-bottom { vertical-align: bottom; }

/* reset inner alignment in figures and tables */
figure.align-left, figure.align-right,
table.align-left, table.align-center, table.align-right {
  text-align: inherit;
}

/* Text Blocks */
.topic { margin: 1em 2em; }
.sidebar,
.admonition,
.system-message {
  margin: 1em 2em;
  border: thin solid;
  padding: 0.5em 1em;
}
div.line-block { display: block; }
div.line-block div.line-block, pre { margin-left: 2em; }

/* Code line numbers: dropped when copying text from the page */
pre.code .ln { display: none; }
pre.code code:before {
  content: attr(data-lineno); /* …, none) fallback not supported by any browser */
  color: gray;
}

/* Tables */
table {
  border-collapse: collapse;
}
td, th {
  border: thin solid silver;
  padding: 0 1ex;
}
.borderless td, .borderless th {
  border: 0;
  padding: 0;
  padding-right: 0.5em /* separate table cells */
}

table > caption, figcaption {
  text-align: left;
  margin-top: 0.2em;
  margin-bottom: 0.2em;
}
table.captionbelow {
  caption-side: bottom;
}

/* MathML (see "math.css" for --math-output=HTML) */
math .boldsymbol { font-weight: bold; }
math.boxed, math .boxed {padding: 0.25em; border: thin solid; }
/* style table similar to AMS "align" or "aligned" environment: */
mtable.cases > mtr > mtd { text-align: left; }
mtable.ams-align > mtr > mtd { padding-left: 0; padding-right: 0; }
mtable.ams-align > mtr > mtd:nth-child(2n) { text-align: left; }
mtable.ams-align > mtr > mtd:nth-child(2n+1) { text-align: right; }
mtable.ams-align > mtr > mtd:nth-child(2n+3) { padding-left: 2em; }
.mathscr mi, mi.mathscr {
  font-family: STIX, XITSMathJax_Script, rsfs10,
               "Asana Math", Garamond, cursive;
}

/* Document Header and Footer */
header { border-bottom: 1px solid black; }
footer { border-top: 1px solid black; }

/* Images are block-level by default in Docutils */
/* New HTML5 block elements: set display for older browsers */
img, svg, header, footer, main, aside, nav, section, figure, video, details {
  display: block;
}
svg { width: auto; height: auto; }  /* enable scaling of SVG images */
/* inline images */
p img, p svg, p video { display: inline; }

</style>
<style type="text/css">

/* CSS31_ style sheet for the output of Docutils HTML writers.             */
/* Rules for easy reading and pre-defined style variants.                  */
/*                                                                         */
/* :Author: Günter Milde, based on html4css1.css by David Goodger          */
/* :Id: $Id: plain.css 9615 2024-04-06 13:28:15Z milde $                                                               */
/* :Copyright: © 2015 Günter Milde.                                        */
/* :License: Released under the terms of the `2-Clause BSD license`_,      */
/*    in short:                                                            */
/*                                                                         */
/*    Copying and distribution of this file, with or without modification, */
/*    are permitted in any medium without royalty provided the copyright   */
/*    notice and this notice are preserved.                                */
/*                                                                         */
/*    This file is offered as-is, without any warranty.                    */
/*                                                                         */
/* .. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause     */
/* .. _CSS3: https://www.w3.org/Style/CSS/                                 */


/* Document Structure */
/* ****************** */

/* "page layout" */
body {
  margin: 0;
  background-color: #dbdbdb;
  --field-indent: 9em; /* default indent of fields in field lists */
}
main, footer, header {
  line-height:1.6;
  /* avoid long lines --> better reading */
  /* optimum is 45…75 characters/line <http://webtypography.net/2.1.2> */
  /* OTOH: lines should not be too short because of missing hyphenation, */
  max-width: 50rem;
  padding: 1px 2%; /* 1px on top avoids grey bar above title (mozilla) */
  margin: auto;
}
main {
  counter-reset: table figure;
  background-color: white;
}
footer, header {
  font-size: smaller;
  padding: 0.5em 2%;
  border: none;
}

/* Table of Contents */
ul.auto-toc > li > p {
  padding-left: 1em;
  text-indent: -1em;
}
nav.contents ul {
  padding-left: 1em;
}
main > nav.contents ul ul ul ul:not(.auto-toc) {
  list-style-type: '\2B29\ ';
}
main > nav.contents ul ul ul ul ul:not(.auto-toc) {
  list-style-type: '\2B1D\ ';
}

/* Transitions */
hr.docutils {
  width: 80%;
  margin-top: 1em;
  margin-bottom: 1em;
  clear: both;
}

/* Paragraphs */

/* vertical space (parskip) */
p, ol, ul, dl, li,
.footnote, .citation,
div > math,
table {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

h1, h2, h3, h4, h5, h6,
dd, details > p:last-child {
  margin-bottom: 0.5em;
}

/* Lists */
/* ===== */

/* Definition Lists */
/* Indent lists nested in definition lists */
dd > ul:only-child, dd > ol:only-child { padding-left: 1em; }

/* Description Lists */
/* styled like in most dictionaries, encyclopedias etc. */
dl.description {
  display: flow-root;
}
dl.description > dt {
  font-weight: bold;
  clear: left;
  float: left;
  margin: 0;
  padding: 0;
  padding-right: 0.3em;
}
dl.description > dd:after {
  display: table;
  content: "";
  clear: left; /* clearfix for empty descriptions */
}

/* Field Lists */

dl.field-list > dd,
dl.docinfo > dd {
  margin-left: var(--field-indent); /* adapted in media queries or HTML */
}

/* example for custom field-name width */
dl.field-list.narrow > dd {
  --field-indent: 5em;
}
/* run-in: start field-body on same line after long field names */
dl.field-list.run-in > dd p {
  display: block;
}

/* Bibliographic Fields */

/* generally, bibliographic fields use dl.docinfo */
/* but dedication and abstract are placed into divs */
div.abstract p.topic-title {
  text-align: center;
}
div.dedication {
  margin: 2em 5em;
  text-align: center;
  font-style: italic;
}
div.dedication p.topic-title {
  font-style: normal;
}

/* disclosures */
details { padding-left: 1em; }
summary { margin-left: -1em; }

/* Text Blocks */
/* =========== */

/* Literal Blocks */
pre.literal-block, pre.doctest-block,
pre.math, pre.code {
  font-family: monospace;
}

/* Block Quotes and Topics */
bockquote { margin: 1em 2em; }
blockquote p.attribution,
.topic p.attribution {
  text-align: right;
  margin-left: 20%;
}

/* Tables */
/* ====== */

/* th { vertical-align: bottom; } */

table tr { text-align: left; }

/* "booktabs" style (no vertical lines) */
table.booktabs {
  border: 0;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.booktabs * {
  border: 0;
}
table.booktabs th {
  border-bottom: thin solid;
}

/* numbered tables (counter defined in div.document) */
table.numbered > caption:before {
  counter-increment: table;
  content: "Table " counter(table) ": ";
  font-weight: bold;
}

/* Explicit Markup Blocks */
/* ====================== */

/* Footnotes and Citations */
/* ----------------------- */

/* line on the left */
.footnote-list {
  border-left: solid thin;
  padding-left: 0.25em;
}

/* Directives */
/* ---------- */

/* Body Elements */
/* ~~~~~~~~~~~~~ */

/* Images and Figures */

/* let content flow to the side of aligned images and figures */
figure.align-left,
img.align-left,
svg.align-left,
video.align-left,
div.align-left,
object.align-left {
  clear: left;
  float: left;
  margin-right: 1em;
}
figure.align-right,
img.align-right,
svg.align-right,
video.align-right,
div.align-right,
object.align-right {
  clear: right;
  float: right;
  margin-left: 1em;
}
/* Stop floating sidebars, images and figures */
h1, h2, h3, h4, footer, header { clear: both; }

/* Numbered figures */
figure.numbered > figcaption > p:before {
  counter-increment: figure;
  content: "Figure " counter(figure) ": ";
  font-weight: bold;
}

/* Admonitions and System Messages */
.caution p.admonition-title,
.attention p.admonition-title,
.danger p.admonition-title,
.error p.admonition-title,
.warning p.admonition-title,
div.error {
  color: red;
}

/* Sidebar */
/* Move right. In a layout with fixed margins, */
/* it can be moved into the margin.            */
aside.sidebar {
  width: 30%;
  max-width: 26em;
  float: right;
  clear: right;
  margin-left: 1em;
  margin-right: -1%;
  background-color: #fffffa;
}


/* Code */
pre.code { padding: 0.7ex }
pre.code, code { background-color: #eeeeee }
/* basic highlighting: for a complete scheme, see */
/* https://docutils.sourceforge.io/sandbox/stylesheets/ */
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}


/* Epigraph           */
/* Highlights         */
/* Pull-Quote         */
/* Compound Paragraph */
/* Container          */

/* Inline Markup */
/* ============= */

sup, sub { line-height: 0.8; } /* do not add leading for lines with sup/sub */

/* Inline Literals                                          */
/* possible values: normal, nowrap, pre, pre-wrap, pre-line */
/*   span.docutils.literal { white-space: pre-wrap; }       */

/* Hyperlink References */
a { text-decoration: none; }

/* External Targets       */
/*   span.target.external */
/* Internal Targets       */
/*   span.target.internal */
/* Footnote References    */
/*   a[role="doc-noteref"] */
/* Citation References    */
/*   a.citation-reference */

</style>
</head>
<body>
<main id="bluetooth-channel-map-updates-1">
<span id="bluetooth-channel-map-updates"></span>
<h1 class="title">Bluetooth: Channel Map Updates</h1>

<p>The Channel Map Updates sample demonstrates an autonomous channel map update algorithm for Bluetooth® Low Energy connections using Quality of Service (QoS) events.
The algorithm automatically evaluates channel performance and generates optimized channel maps to improve connection reliability.</p>
<section id="requirements">
<h2>Requirements</h2>
<p>The sample supports the following development kits:</p>
<p>See the supported boards listed in <span class="docutils literal">samples/bluetooth/channel_map_updates/sample.yaml</span>.</p>
<p>You need at least two development kits to physically test this sample:</p>
<ul class="simple">
<li><p>This sample currently supports channel map updates to one peripheral device. To demonstrate it, you need two development kits.</p></li>
</ul>
<p>You can mix different development kits from the list above.</p>
<p>The sample also requires a connection to a computer with a serial terminal for each of the development kits.</p>
</section>
<section id="overview">
<h2>Overview</h2>
<p>The sample implements a hardware-based channel map update algorithm that uses connection event reports to collect Quality of Service data.
It automatically evaluates channel performance based on CRC errors and RX timeouts, then generates optimized channel maps to improve connection reliability.</p>
<p>The sample can operate in two roles:</p>
<ul class="simple">
<li><p><strong>Central (tester)</strong>: Initiates connections and collects QoS statistics.</p></li>
<li><p><strong>Peripheral (peer)</strong>: Accepts connections and participates in the channel evaluation process.</p></li>
</ul>
<section id="algorithm-description">
<h3>Algorithm Description</h3>
<section id="rating-calculation">
<h4>Rating Calculation</h4>
<p>The algorithm evaluates each channel after collecting a configurable number of samples using the following formula:</p>
<pre class="code text literal-block"><code>rating = (1.0f - w_3) * prev_rating + w_3 * (1.0f - (w_1 * crc_error_rate + w_2 * rx_timeout_rate));</code></pre>
<p>Where:</p>
<ul class="simple">
<li><p><span class="docutils literal">w_1</span>: Weight for CRC errors</p></li>
<li><p><span class="docutils literal">w_2</span>: Weight for RX timeouts</p></li>
<li><p><span class="docutils literal">w_3</span>: Weight for old rating</p></li>
<li><p><span class="docutils literal">crc_error_rate</span>: <span class="docutils literal">crc_errors / packets_sent</span></p></li>
<li><p><span class="docutils literal">rx_timeout_rate</span>: <span class="docutils literal">rx_timeouts / packets_sent</span></p></li>
<li><p><span class="docutils literal">prev_rating</span>: The rating from the previous evaluation</p></li>
</ul>
</section>
<section id="channel-map-generation">
<h4>Channel Map Generation</h4>
<p>Channels are included in the channel map if and only if:</p>
<ol class="arabic simple">
<li><p>Their rating is above a configurable threshold (default: 0.8).</p></li>
<li><p>The number of active channels is greater than the minimum configurable amount (default: 3), to prevent failure of the adaptive channel hopping algorithm.</p></li>
</ol>
</section>
</section>
<section id="key-features">
<h3>Key Features</h3>
<ul class="simple">
<li><p><strong>Autonomous Operation</strong>: Automatically collects QoS data and updates channel maps.</p></li>
<li><p><strong>Configurable Parameters</strong>: Adjustable weights and thresholds for different environments.</p></li>
<li><p><strong>Rating System</strong>: Each channel gets a performance rating based on CRC errors and RX timeouts.</p></li>
<li><p><strong>Minimum Channel Guarantee</strong>: Ensures a minimum number of active channels for connectivity.</p></li>
</ul>
</section>
</section>
<section id="user-interface">
<h2>User interface</h2>
<p>The sample uses a console interface to select the device role:</p>
<ul class="simple">
<li><p>Type <span class="docutils literal">c</span> to set the device as central (tester)</p></li>
<li><p>Type <span class="docutils literal">p</span> to set the device as peripheral (peer)</p></li>
</ul>
</section>
<section id="building-and-running">
<h2>Building and running</h2>
<p>Sample path: <span class="docutils literal">samples/bluetooth/channel_map_updates</span></p>
<p>For physical DKs: Build and flash the sample for two development kits (one acting as central, one as peripheral) using your usual nRF Connect SDK workflow (for example, with <span class="docutils literal">west build</span> and <span class="docutils literal">west flash</span>). Refer to the nRF Connect SDK documentation for detailed build and flashing instructions.</p>
<p>For BabbleSim: Build the sample then go to the testing steps below:</p>
<pre class="code bash literal-block"><code>west<span class="whitespace"> </span>build<span class="whitespace"> </span>-b<span class="whitespace"> </span>nrf54l15bsim/nrf54l15/cpuapp</code></pre>
<section id="testing">
<h3>Testing</h3>
</section>
</section>
<section id="testing-physical-dks">
<h2>Testing Physical DKs:</h2>
<p>After programming the sample to both development kits, complete the following steps to test it:</p>
<ol class="arabic">
<li><p>Connect a terminal emulator to both development kits.</p></li>
<li><p>Reset both kits.</p></li>
<li><p>On the first development kit, type <span class="docutils literal">c</span> in the terminal to set it as central (tester).</p></li>
<li><p>On the second development kit, type <span class="docutils literal">p</span> in the terminal to set it as peripheral (peer).</p></li>
<li><p>Observe that the kits establish a connection. The central will start gathering QoS statistics.</p></li>
<li><p>After the evaluation interval is reached (default: 2000 packets), the algorithm will run.</p></li>
<li><p>After a set number of evaluations (default: 5), an evaluation report is printed showing:</p>
<p>On Central Unit
* Channel statistics (packets sent, CRC errors, RX timeouts)
* Channel ratings
* Channel states (active/inactive)
* Updated channel map application</p>
<p>On Peripheral Unit
* Prints the Channel Map if it has been updated from last iteration</p>
</li>
</ol>
</section>
<section id="testing-in-simulation">
<h2>Testing in Simulation:</h2>
<ol class="arabic">
<li><p>Start two instances of the BabbleSim board (one acting as central, one as peripheral):</p>
<pre class="code bash literal-block"><code><span class="name builtin">cd</span><span class="whitespace"> </span>build/zephyr<span class="whitespace">
</span>./zephyr.exe<span class="whitespace"> </span>-s<span class="operator">=</span>&lt;simulator_name&gt;<span class="whitespace"> </span>-p<span class="operator">=</span>&lt;phy_name&gt;<span class="whitespace"> </span>-d<span class="operator">=</span>&lt;device_id&gt;</code></pre>
<p>Replace the placeholders to match your BabbleSim setup.</p>
</li>
<li><p>In the first terminal, type <span class="docutils literal">c</span> to set it as central (tester).</p></li>
<li><p>In the second terminal, type <span class="docutils literal">p</span> to set it as peripheral (peer).</p></li>
<li><p>Start an interferer (optional), for example the burst interferer that is installed together with BabbleSim:</p>
<pre class="code bash literal-block"><code><span class="name builtin">cd</span><span class="whitespace"> </span>&lt;babblesim_root&gt;/tools/bsim/bin<span class="whitespace">
</span>./bs_device_2G4_burst_interf<span class="whitespace"> </span>-s<span class="operator">=</span>&lt;simulator_name&gt;<span class="whitespace"> </span>-p<span class="operator">=</span>&lt;phy_name&gt;<span class="whitespace"> </span>-d<span class="operator">=</span>&lt;device_id&gt;<span class="whitespace"> </span>-type<span class="operator">=</span>WLAN<span class="whitespace"> </span>-centerfreq<span class="operator">=</span><span class="literal number">2440</span><span class="whitespace"> </span>-power<span class="operator">=</span><span class="literal number">10</span></code></pre>
<p>This starts a WLAN-like interference process centered at 2440 MHz with 10 dBm power.</p>
</li>
<li><p>Start the physical layer used by the devices:</p>
<pre class="code bash literal-block"><code><span class="name builtin">cd</span><span class="whitespace"> </span>&lt;babblesim_root&gt;/tools/bsim/bin<span class="whitespace">
</span>./bs_2G4_phy_v1<span class="whitespace"> </span>-s<span class="operator">=</span>&lt;simulator_name&gt;<span class="whitespace"> </span>-p<span class="operator">=</span>&lt;phy_name&gt;<span class="whitespace"> </span>-D<span class="operator">=</span>&lt;total_devices&gt;<span class="whitespace"> </span>-sim_length<span class="operator">=</span>10e8<span class="whitespace"> </span>-channel<span class="operator">=</span>Indoorv1<span class="whitespace"> </span>-defmodem<span class="operator">=</span>BLE_simple</code></pre>
<p>This starts a physical layer process with the Indoorv1 channel preset and the BLE_simple modem for more realistic packet transfer.</p>
</li>
<li><p>Observe that the devices establish a connection. The central will start gathering QoS statistics.</p></li>
<li><p>After the evaluation interval is reached (default: 2000 packets), the algorithm will run.</p></li>
<li><p>After a set number of evaluations (default: 5), an evaluation report is printed showing:</p></li>
</ol>
<section id="sample-output">
<h3>Sample output</h3>
<p>The result should look similar to the following output on the central device:</p>
<pre class="literal-block">*** Booting nRF Connect SDK v3.0.2-89ba1294ac9b ***
*** Using Zephyr OS v4.0.99-f791c49f492c ***
Starting Bluetooth Standard Connection Sample
Starting Bluetooth Channel Map Update Sample
I: SoftDevice Controller build revision:
I: 89 9a 50 8a 95 01 9c 58 |..P....X
I: fc 39 d2 c1 10 04 ee 02 |.9......
I: 64 ce 25 be             |d.%.
I: HW Platform: Nordic Semiconductor (0x0002)
I: HW Variant: nRF54Lx (0x0005)
I: Firmware: Standard Bluetooth controller (0x00) Version 137.20634 Build 261734951
I: Bluetooth initialized

I: Choose device role - type c (central) or p (peripheral):
I: Central. Starting scanning
I: Channel map and algorithm initialized
Algorithm will evaluate every 2000 packets
Scanning successfully started

Filters matched. Address: D2:A9:E7:9A:A7:72 (random) connectable: 1
Connected as central
Connection interval: 6 units (7.5 ms)
Security changed: level 2, err: 0
Service discovery completed

Channel map evaluation completed successfully
Active channels: 33
I: Applying new channel map
I: Successfully applied channel map

.
.
.

I:
--- Algorithm Channel Report ---
I: Ch | Total_packets_sent  | CRC_Errors | RX_Timeouts | Rating Made | Last Rating | State
I: ---|---------------------|------------|-------------|-------------|-------------|-------
I:  0 |                 661 |          0 |          11 |       0.986 |       0.985 | 1
I:  1 |                 647 |          0 |          17 |       0.977 |       0.975 | 1
I:  2 |                 632 |          0 |          11 |       0.986 |       0.989 | 1
I:  3 |                 626 |          0 |          14 |       0.981 |       0.979 | 1
I:  4 |                 658 |          0 |          12 |       0.985 |       0.986 | 1
I:  5 |                 629 |          0 |          15 |       0.980 |       0.980 | 1
I: ...
I: 20 |                 281 |          4 |          82 |       0.780 |       1.000 | 0
I: 21 |                 264 |          2 |         149 |       0.579 |       1.000 | 0
I: 22 |                 283 |          3 |         240 |       0.368 |       1.000 | 0
I: 23 |                 282 |          3 |         211 |       0.442 |       1.000 | 0
I: 24 |                 272 |          0 |         132 |       0.639 |       1.000 | 0
I: ...</pre>
<p>The result should look similar to the following output on the peripheral device:</p>
<pre class="literal-block">*** Booting nRF Connect SDK v3.0.2-89ba1294ac9b ***
*** Using Zephyr OS v4.0.99-f791c49f492c ***
I: Starting Bluetooth Channel Map Update Sample

I: SoftDevice Controller build revision:
I: 89 9a 50 8a 95 01 9c 58 |..P....X
I: fc 39 d2 c1 10 04 ee 02 |.9......
I: 64 ce 25 be             |d.%.
I: HW Platform: Nordic Semiconductor (0x0002)
I: HW Variant: nRF54Lx (0x0005)
I: Firmware: Standard Bluetooth controller (0x00) Version 137.20634 Build 2617349514
I: Identity: D2:A9:E7:9A:A7:72 (random)
I: HCI: version 6.0 (0x0e) revision 0x30f3, manufacturer 0x0059
I: LMP: version 6.0 (0x0e) subver 0x30f3
I: Bluetooth initialized

I: Choose device role - type c (central) or p (peripheral):
I: Peripheral. Starting advertising

Advertising successfully started
Connected as peripheral
Connection interval: 6 units (7.5 ms)
Security changed: level 2, err: 0
Service discovery completed

Detected Channel Map Update, (formatted CH36 down to CH0)
LL channel map, HEX: 1f ff ff ff ff
LL channel map, BITS: 1111111111111111111111111111111111111

Detected Channel Map Update, (formatted CH36 down to CH0)
LL channel map, HEX: 1f fb ff ff ff
LL channel map, BITS: 1111111111011111111111111111111111111

.
.
.

Detected Channel Map Update, (formatted CH36 down to CH0)
LL channel map, HEX: 1f c3 ff 5f ff
LL channel map, BITS: 1111111000011111111110101111111111111

Detected Channel Map Update, (formatted CH36 down to CH0)
LL channel map, HEX: 1f c3 ff 4f ff
LL channel map, BITS: 1111111000011111111110100111111111111</pre>
</section>
</section>
<section id="dependencies">
<h2>Dependencies</h2>
<p>This sample uses the following nRF Connect SDK libraries:</p>
<ul class="simple">
<li><p><span class="docutils literal">latency</span></p></li>
<li><p><span class="docutils literal">latency_client</span></p></li>
<li><p><span class="docutils literal">gatt_dm</span></p></li>
<li><p><span class="docutils literal">nrf_bt_scan</span></p></li>
</ul>
<p>In addition, it uses the following Zephyr components and headers:</p>
<ul class="simple">
<li><p><span class="docutils literal">include/zephyr/types.h</span></p></li>
<li><p><span class="docutils literal">include/console.h</span></p></li>
<li><p>Kernel API (<span class="docutils literal">include/kernel.h</span>)</p></li>
<li><p><span class="docutils literal">include/sys/printk.h</span></p></li>
<li><p>Bluetooth API (<span class="docutils literal">include/bluetooth/bluetooth.h</span>, <span class="docutils literal">include/bluetooth/conn.h</span>, <span class="docutils literal">include/bluetooth/gatt.h</span>, <span class="docutils literal">include/bluetooth/hci.h</span>, <span class="docutils literal">include/bluetooth/uuid.h</span>)</p></li>
<li><p>Logging API (<span class="docutils literal">include/logging/log.h</span>)</p></li>
</ul>
</section>
</main>
</body>
</html>
